<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<!--    <link href="./assets/images/favicon.ico" rel="icon">-->
		<title>再生工厂智慧生产管理系统</title>
		<link rel="stylesheet" href="./assets/libs/layui/css/layui.css" />
		<link rel="stylesheet" href="./assets/module/admin.css?v=3145" />
		<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
		<style>
			#logo.cj-logo {
    			text-align: left;
    		}
    		#logo.cj-logo img,
    		#logo.sh-logo img{
    			background-color: transparent;
    		}
    	</style>
	</head>
	<body class="layui-layout-body">
		<div class="layui-layout layui-layout-admin">
			<!-- 头部 -->
			<div class="layui-header">
				<div class="layui-logo" id="logo">
					<img id="layui-logo-img" src="./assets/images/cjlogo.png" />
				</div>
				<ul class="layui-nav layui-layout-left">
					<li class="layui-nav-item" lay-unselect>
						<a ew-event="flexible" title="侧边伸缩"><i class="layui-icon layui-icon-shrink-right"></i></a>
					</li>
					<!-- <li class="layui-nav-item" lay-unselect>
						<a ew-event="refresh" title="刷新"><i class="layui-icon layui-icon-refresh-3"></i></a>
					</li> -->
					<li class="layui-nav-item" lay-unselect>
						<h5 class="nav_title">再生工厂智慧生产管理系统</h5>
					</li>
				</ul>

				<!--        <h5 class="index_title">再生工厂智慧生产管理系统</h5>-->

				<ul class="layui-nav layui-layout-right">
					<li class="layui-nav-item" lay-unselect>
						<a>
							<cite class="username">你好~ </cite>
							<img src="assets/images/head.png" class="layui-nav-img">
							<dl class="layui-nav-child">
								<dd lay-unselect>
									<a ew-href="page/template/user-info.html">个人中心</a>
								</dd>
								<dd lay-unselect>
									<a ew-event="psw">修改密码</a>
								</dd>
								<hr>
								<dd lay-unselect>
									<a onclick="getloginout()" href="javascript:;">退出</a>
								</dd>
							</dl>
						</a>
					</li>
					<li class="layui-nav-item" lay-unselect>
						<a>
							<cite class="zhandian_name">站点名称 </cite>
							<dl class="layui-nav-child zhandian_list">
								<!-- <dd lay-unselect>
									<a ew-href="page/template/user-info.html">个人中心</a>
								</dd>
								<dd lay-unselect>
									<a ew-event="psw">修改密码</a>
								</dd> -->
							</dl>
						</a>

					</li>
					<li class="layui-nav-item" lay-unselect>
						<a>
							<cite class="shebei_name">设备名称 </cite>
							<dl class="layui-nav-child shebei_list">
								<!-- <dd lay-unselect>
									<a ew-href="page/template/user-info.html">个人中心</a>
								</dd>
								<dd lay-unselect>
									<a ew-event="psw">修改密码</a>
								</dd> -->
							</dl>
						</a>

					</li>
					<li class="layui-nav-item" lay-unselect>
						<a ew-event="message" title="消息">
							<i class="layui-icon layui-icon-notice"></i>
							<span class="layui-badge-dot"></span>
							<!--小红点-->
						</a>
					</li>
					<li class="layui-nav-item" lay-unselect>
						<!--<a ew-event="note" title="便签"><i class="layui-icon layui-icon-set"></i></a>-->
					</li>
					<!--            <li class="layui-nav-item layui-hide-xs" lay-unselect>-->
					<!--                <a ew-event="fullScreen" title="全屏"><i class="layui-icon layui-icon-screen-full"></i></a>-->
					<!--            </li>-->

					<li class="layui-nav-item" lay-unselect>
						<!--<a ew-event="theme" title="主题"><i class="layui-icon layui-icon-more-vertical"></i></a>-->

					</li>
				</ul>
			</div>

			<!-- 侧边栏 -->
			<div class="layui-side">
				<div class="layui-side-scroll">
					<ul id="ul_menu" class="layui-nav layui-nav-tree arrow2" lay-filter="admin-side-nav" lay-accordion="true" style="margin-top: 15px;">
						<li class="layui-nav-item">
							<a lay-href="page/console/console.html"><i class="layui-icon layui-icon-home"></i>&emsp;<cite>首页</cite></a>
						</li>
						<li class="layui-nav-item">
							<a lay-href=''><i class="layui-icon layui-icon-template"></i>&emsp;<cite>综合展示</cite></a>
							<dl class="layui-nav-child">
								<dd><a href="page/ComprehensiveDisplay/index.html" target="view_window">首页</a></dd>
								<dd><a lay-href="page/ComprehensiveDisplay/proMonitor.html">生产管控</a></dd>
								<dd><a lay-href="page/ComprehensiveDisplay/videoMonitor.html">视频监控</a></dd>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-theme"></i>&emsp;<cite>生产管理</cite></a>
							<dl class="layui-nav-child">
								<dd><a><i class="layui-icon layui-icon-template"></i>&emsp;<cite>质量控制</cite></a>
									<dl class="layui-nav-child">
										<dd><a lay-href="page/productionControl/produceTrends.html">生产动态表</a></dd>
										<dd><a lay-href="page/productionControl/temperature.html">温度波动分析</a></dd>
										<dd><a lay-href="page/productionControl/petroleum.html">油石比分析</a></dd>
									</dl>
								</dd>
								<dd><a>生产管控</a>
									<dl class="layui-nav-child">
										<dd><a lay-href="page/produceMAC/weigh_kucun.html">库存盘点</a></dd>
										<dd><a lay-href='page/ComprehensiveDisplay/proMonitor.html'>生产管控</a></dd>
									</dl>
								</dd>

								<dd><a>生产报表</a>
									<dl class="layui-nav-child">
										<dd><a lay-href="page/produceReport/producenum.html">生产量分析</a></dd>
										<dd><a lay-href="page/produceReport/xhl.html">消耗量分析</a></dd>
										<dd><a lay-href="page/produceReport/hslfx.html">核算量分析</a></dd>
										<dd><a lay-href="page/produceReport/monthcharts.html">生产月报</a></dd>
									</dl>
								</dd>

								<dd><a lay-href="http://baidu.com">生产效率</a>
								<dd><a lay-href="11">质量设置</a>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-template-1"></i>&emsp;<cite>设备管理</cite></a>
							<dl class="layui-nav-child">

								<dd><a>资产管理</a></dd>
								<dd><a lay-href="page/template/empty.html">设备维修</a></dd>
								<dd><a lay-href="page/template/maintain/maintain.html" target="_blank">保养维护</a>
								</dd>
								<dd><a lay-href="page/template/message.html">提醒设置</a></dd>
							</dl>
						</li>

						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-rmb"></i>&emsp;<cite>成本管理</cite></a>
							<dl class="layui-nav-child">
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-read"></i>&emsp;<cite>实验管理</cite></a>
							<dl class="layui-nav-child">
								<dd><a>二级菜单</a></dd>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-chart-screen"></i>&emsp;<cite>运输管理</cite></a>
							<dl class="layui-nav-child">
								<dd><a lay-href="page/TransportationManagement/VehicleScheduling.html">车辆调度</a></dd>
								<dd><a lay-href="page/TransportationManagement/DistanceAnalysis.html">运距分析</a></dd>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-util"></i>&emsp;<cite>安全管理</cite></a>
							<dl class="layui-nav-child">
								<dd><a>安全巡检</a></dd>
								<dd><a lay-href="page/SafetyManagement/SecurityMonitoring.html">安全监控</a></dd>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-templeate-1"></i>&emsp;<cite>环保管理</cite></a>
							<dl class="layui-nav-child">
								<dd><a lay-href="page/SafetyManagement/VideoDetection.html">视频检测</a></dd>
								<dd><a>环保检测</a></dd>
							</dl>
						</li>
						<li class="layui-nav-item">
							<a><i class="layui-icon layui-icon-set"></i>&emsp;<cite>系统设置</cite></a>
							<dl class="layui-nav-child">
								<dd><a lay-href="page/system/user.html">用户管理</a></dd>
								<dd><a lay-href="page/system/role.html">角色管理</a></dd>
								<dd><a lay-href="page/system/site.html#/id-6">站点管理</a></dd>
								<dd><a lay-href="page/system/message.html">消息管理</a></dd>
								<dd><a lay-href="page/system/menu.html">菜单管理</a></dd>
								<dd><a>权限管理</a></dd>
								<dd><a>信息发布</a></dd>
							</dl>
						</li>
					</ul>
				</div>
			</div>
			<table>
				<tr>
					<td rowspan="" colspan=""></td>
				</tr>
			</table>
			<!-- 主体部分 -->
			<div class="layui-body"></div>
			<!-- 底部 -->
			<!-- <div class="layui-footer">
				copyright © 2019 <a href="http://easyweb.vip" target="_blank">easyweb.vip</a> all rights reserved.
				<span class="pull-right">Version 3.1.4</span>
			</div> -->
		</div>

		<!-- 加载动画 -->
		<div class="page-loading">
			<div class="ball-loader">
				<span></span><span></span><span></span><span></span>
			</div>
		</div>

		<!-- js部分 -->
		<script type="text/javascript" src="./assets/libs/layui/layui.js"></script>
		<script type="text/javascript" src="./assets/js/common.js?v=314"></script>
		<script type="text/javascript" src="./assets/js/jquery-2.1.1.min.js"></script>
		<script>
			function getloginout() {
				layer.confirm('确定要退出系统吗？', {
					skin: 'layui-layer-admin',
					shade: .1
				}, function(i) {
					localStorage.clear();
					if (projectName == "guangzhou") {
						window.location.href = "./page/template/login.html?page=gz";
					} else if (projectName == "shanghai") {
						window.location.href = "./page/template/login.html?page=sh";
					} else if (projectName == "chongjiao") {
						window.location.href = "./page/template/login-重交.html";
					} else if (projectName == "cangzhou") {
						window.location.href = "./page/template/login-沧州.html?page=cz";
					}
					else {
						window.location.href = "./page/template/login.html?page=bz";
					}
				});
			}
			// 设置顶部标题
			let topTitle ="";
			if(projectName==='chongjiao'){
				topTitle='智慧生产管控系统—沥青砼';
			}else if(projectName==='cangzhou'){
				topTitle='沥青路面智能管理系统';
			}
			else{
				topTitle='沥青混合料智慧生产管控系统';
			}
			$('.nav_title').text(topTitle);
			document.title = topTitle;
			
			// 设置logo
			let logo = projectName === 'chongjiao' ? '<img src="./assets/images/log.png" />' : (projectName === 'shanghai' ?
				'<img src="./assets/images/logo_shanghai.png" />' : (projectName === 'cangzhou' ?'<img src="./assets/images/cangzhou.png" style="background-color:#101B3F" />':'<img src="./assets/images/logo_guangzhou.png" />'));
			if (projectName === 'chongjiao') {
				$('#logo').addClass('cj-logo');
			} else if (projectName === 'shanghai') {
				$('#logo').addClass('sh-logo');
			}
			if(projectName === 'cangzhou'){
				$(".layui-layout-admin .layui-header .layui-logo").css("background-color","#101B3F");
				$(".layui-layout-admin .layui-side").css("background-color","#101B3F");
			}
			$('#logo').html(logo);
			if (localStorage.getItem("token") == undefined || localStorage.getItem("token") == null || localStorage.getItem(
					"token") == "") {
				if (projectName == "chongjiao") {
					window.location.href = "./page/template/login-重交.html";
				} else if (projectName == "guangzhou") {
					window.location.href = "./page/template/login-广州.html";
				} else if (projectName == "cangzhou") {
					window.location.href = "./page/template/login-沧州.html";
				}else {
					window.location.href = "./page/template/login-拌站精灵.html";
				}
			}
			var element = '';
			layui.use(['index', 'element'], function() {
				var $ = layui.jquery;
				var index = layui.index;
				element = layui.element;
				var username = localStorage.getItem("username");
				$(".username").text(username);

				//var station_array = ("璧山站,双石站,两江站,朱沱站").split(',');
				// 默认加载主页
				index.loadHome({
					menuPath: 'page/console/console.html',
					menuName: '<i class="layui-icon layui-icon-home"></i>'
				});
				BindUserzdList();
				BindUserMenu();
				BindShebeiList();
			});

			function getzhandian1(zhandian, idzhandian) {
				$(".zhandian_name").text(zhandian);
				localStorage.setItem("station", zhandian);
				localStorage.setItem("station_id", idzhandian);
				window.location.reload();
				BindUserMenu();
			}

			function getshebei1(shebei_name, shebei_id) {
				$(".shebei_name").text(shebei_name);
				localStorage.setItem("shebei_name", shebei_name);
				localStorage.setItem("shebei_id", shebei_id);
				window.location.reload();
			}
			// $(function() {
			// 	BindUserzdList();
			// 	BindUserMenu();
			// })
			//localStorage.removeItem('station');
			//绑定用户站点列表
			function BindUserzdList() {
				$.ajax({
					type: "get",
					url: url + '/zhandian/getRoleZhandian',
					data: {
						role_id: localStorage.getItem("role_id")
					},
					async: false,
					success: function(res) {
						if (res.code == 0) {
							var html = '';
							$.each(res.list, function(index, item) {
								if (index == 0 && localStorage.getItem("station") == null) {
									$(".zhandian_name").text(item.zdname);
									localStorage.setItem("station", item.zdname);
									localStorage.setItem("station_id", item.idzhandian);
								} else if (localStorage.getItem("station") != null) {
									$(".zhandian_name").text(localStorage.getItem("station"));
								}
								html += '<dd lay-unselect>';
								html += '<a onclick=\'getzhandian1("' + item.zdname + '","' + item.idzhandian + '")\'>' + item.zdname +
									'</a>';
								html += '</dd>';
							})
							$(".zhandian_list").html(html);
						}
					}
				});
			}

			function BindShebeiList() {
				$.ajax({
					type: "get",
					url: url + '/zhandian/getSheBeiList',
					data: {
						zd_id: localStorage.getItem("station_id")
					},
					async: false,
					success: function(res) {
						if (res.code == 0) {
							var html = '';
							$.each(res.list, function(index, item) {
								if (item.shebei_name != null) {
									if (index == 0 && localStorage.getItem("shebei_id") == null) {
										$(".shebei_name").text(item.shebei_name);
										localStorage.setItem("shebei_id", item.id);
										localStorage.setItem("shebei_name", item.shebei_name);
									} else if (localStorage.getItem("shebei_id") != null) {
											$(".shebei_name").text(localStorage.getItem("shebei_name"));
									}
									html += '<dd lay-unselect>';
									html += '<a onclick=\'getshebei1("' + item.shebei_name + '","' + item.id + '")\'>' + item.shebei_name +
										'</a>';
									html += '</dd>';
								}

							})
							$(".shebei_list").html(html);
						}
					}
				});
			}

			function BindUserMenu() {
				var roleId = localStorage.getItem("role_id");
				var role = localStorage.getItem("role");
				if (role == "administrator") {
					roleId = "";
				}
				$.ajax({
					type: "get",
					url: url + '/user/getUserMenuList',
					data: {
						roleId: roleId,
						zdId: localStorage.getItem("station_id")
					},
					async: false,
					success: function(res) {
						if (res.code == 0) {
							//console.log(res.data);
							var html = '';
							$.each(res.data, function(index, item) {
								html += '<li class="layui-nav-item">';
								html += '<a lay-href="' + item.path + '"><i class="layui-icon ' + item.icon + '"></i>&emsp;<cite>' + item.name +
									'</cite></a>';
								if (item.child.length > 0) {
									html += '<dl class="layui-nav-child">';
									var child_1 = item.child;
									for (var i = 0; i < child_1.length; i++) {
										if (child_1[i].path == "page/ComprehensiveDisplay/index.html") //特殊处理
										{
											html += '<dd><a href="' + child_1[i].path + '" target="view_window"><i class="layui-icon ' + child_1[i]
												.icon +
												'"></i>&emsp;<cite>' + child_1[i].name + '</cite></a>';
										} else {
											html += '<dd><a lay-href="' + child_1[i].path + '"><i class="layui-icon ' + child_1[i].icon +
												'"></i>&emsp;<cite>' + child_1[i].name + '</cite></a>';
										}
										if (child_1[i].child.length > 0) {
											var child_2 = child_1[i].child;
											html += '<dl class="layui-nav-child">';
											for (var j = 0; j < child_2.length; j++) {
												html += '<dd><a lay-href="' + child_2[j].path + '">' + child_2[j].name + '</a></dd>';
											}
											html += '</dl>';
										}
									}
									html += '</dd>';
									html += '</dl>';
								}
								html += '</li>';
							});
							$("#ul_menu").html(html);
							element.init();
						} else {}
					}
				});
			}
		</script>
	</body>
</html>
