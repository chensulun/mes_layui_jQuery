<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title>生产月报</title>
		<link rel="stylesheet" href="../../assets/libs/layui/css/layui.css" />
		<link rel="stylesheet" href="../../assets/module/admin.css?v=314" />
		<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
		<style>
			/*.layui-layer-setwin {*/
        /*    position: absolute;*/
        /*    right: 15px;*/
        /*    *right: 0;*/
        /*    top: 15px;*/
        /*    font-size: 0;*/
        /*    line-height: initial;*/
        /*}*/
		
		.my_title{
			width: 110px;
			height: 34px;
			background-color: #26C44F;
			text-align: center;
			color: #FFFFFF;
			font-size: 14px;
			line-height: 34px;
			float: left;
		}
		.xxk{
			width: 110px;
			height: 44px;
			font-size: 16px;
			color: #333333;
			line-height: 44px;
			text-align: center;
			float: left;
			cursor: pointer;
		}
		
		.xxk_action
		{
			border-radius: 8px 8px 0px 0px;
			background-color: #26C44F;
			color: #FFFFFF;
			font-weight: bold;
			cursor: pointer;
		}
		
		.kccheck{
			height: 34px;
			width: 162px;
			border: 1px solid #26C44F;
			border-radius: 17px;
			margin-left: 21px;
		}
		
		.kcchecked
		{
			float: left;
			height: 30px;
			width: 79px;
			margin-top: 2px;
			line-height: 30px;
			text-align: center;
			font-size: 14px;
			color: #333333;
			cursor: pointer;
		}
		
		.kcchecked_action
		{
			background-color: #26C44F;
			border-radius: 17px;
			color: #FFFFFF;
		}
		
		.querydiv{
			margin-top: 19px;
			width: 100%;
			padding-left: 21px;
			box-sizing: border-box;
		}
		
		.title{
			width: 119px;
			height: 34px;
			background-color: #26C44F;
			font-size: 14px;
			color: #FFFFFF;
			line-height: 34px;
			text-align: center;
			float: left;
		}
		
		.qdk{
			width: 70px;
			height: 34px;
			float: left;
			margin-left: 13px;
			border:1px solid #E6E6E6;
			border-radius: 4px;
			text-align: center;
			line-height: 34px;
			font-size: 14px;
			color: #333333;
			cursor: pointer;
		}
		
		.querytxt{
			height: 34px;
			line-height: 34px;
			font-size: 14px;
			color: #333333;
			margin-left: 13px;
			float: left;
		}
		
		.mytime
		{
			width: 100px;
			height: 34px;
			border:1px solid #26C44F;
			border-radius: 17px;
			float: left;
			text-align: center;
		}
		
		.fgx{
			height: 34px;
			line-height: 34px;
			color: #59CBB1;
			text-align: center;
			float: left;
			margin-left: 4px;
		}
		
		.subbtn{
			width: 71px;
			height: 34px;
			background-color: #26C44F;
			border-radius: 2px;
			font-size: 14px;
			text-align: center;
			line-height: 34px;
			color: #FFFFFF;
			float: left;
			border: none;
			margin-left: 26px;
		}
		
		.table_div{
			width: 100%;
		}
		
		.qdkaction{
			background-image: url('../../assets/images/选中@2x.png');
			background-size: 34px 21px;
			background-repeat: no-repeat;
			background-position: top right;
		}
		
		.myselect{
			height: 34px;
			width: 90px;
			font-size: 14px;
			line-height: 34px;
			color: #333333;
			float: left;
			border:1px solid #CCCCCC;
			border-radius: 4px;
		}
		
		table td{
			font-size: 12px !important;
		}
    </style>
	</head>
	<body>

		<!-- 页面加载loading -->
		<div class="page-loading">
			<div class="ball-loader">
				<span></span><span></span><span></span><span></span>
			</div>
		</div>

		<!-- 正文开始 -->
		<div class="layui-fluid">
			<div style="width: 100%;border-radius: 8px;">
				<div id="kucun" class="kucun-chart" style="height: 15.05rem;width:100%;border-radius: 29px;">
				</div>
			</div>
			<div style="margin-top: 30px;">
				<div data="bd" class="xxk xxk_action">
					榜单管理
				</div>
				<div data="kc" class="xxk">
					库存管理
				</div>
				<div style="clear: both;"></div>
			</div>
			<!--榜单-->
			<div id="bd" class="layui-card" style="display: block;width: 80%;float: left;">
				<div class="querydiv" style="margin-top: 0px;padding-top: 19px;">
					<div name="radio_bd" class="qdk qdkaction">当日</div>
					<div name="radio_bd" class="qdk">本周</div>
					<div name="radio_bd" class="qdk">本月</div>
					<input type="text" id="bdstartTime" readonly="readonly" class="mytime" style="margin-left: 13px;" placeholder="开始日期" />
					<div class="fgx">-</div>
					<input type="text" id="bdendTime" readonly="readonly" class="mytime" style="margin-left: 4px;" placeholder="结束日期" />
					<input type="button" value="确定" id="btn_time_3" class="subbtn" />
					<div class="querytxt">榜单类型：</div>
					<select id="bdtype" class="myselect">
						<option value="">-请选择-</option>
						<option value="销售发货">销售发货</option>
						<option value="采购收货">采购收货</option>
						<option value="作废">作废</option>
					</select>
					<div style="clear: both;">
					</div>
				</div>
				<div class="table_div">
					<table class="layui-table" id="test3" lay-filter="tableUser">

					</table>
				</div>
			</div>
			<!--榜单-->
			<!--库存-->
			<div id="kc" class="layui-card" style="display: none;padding-top: 19px;width: 80%;float: left;">
				<div class="kccheck">
					<div id="button-name" style="margin-left: 2px;" class="kcchecked kcchecked_action">理论</div>
					<div id="button-name2" class="kcchecked">实时</div>
				</div>
				<div class="querydiv">
					<div class="title">进料看板</div>
					<div name="radio_jinliao" class="qdk qdkaction">当日</div>
					<div name="radio_jinliao" class="qdk">本周</div>
					<div name="radio_jinliao" class="qdk">本月</div>
					<input type="text" id="startTime" readonly="readonly" class="mytime" style="margin-left: 13px;" placeholder="开始日期" />
					<div class="fgx">-</div>
					<input type="text" id="endTime" readonly="readonly" class="mytime" style="margin-left: 4px;" placeholder="结束日期" />
					<input type="button" value="确定" id="btn_time_1" class="subbtn" />
					<div style="clear: both;">
					</div>
				</div>
				<div class="table_div">
					<table class="layui-table" id="test" lay-filter="tableUser">

					</table>
				</div>
				<div class="querydiv" style="margin-top: 100px;">
					<div class="title">消耗看板</div>
					<div name="radio_chuliao" class="qdk qdkaction">当日</div>
					<div name="radio_chuliao" class="qdk">本周</div>
					<div name="radio_chuliao" class="qdk">本月</div>
					<input type="text" id="startTime1" readonly="readonly" class="mytime" style="margin-left: 13px;" placeholder="开始日期" />
					<div class="fgx">-</div>
					<input type="text" id="endTime1" readonly="readonly" class="mytime" style="margin-left: 4px;" placeholder="结束日期" />
					<input type="button" value="确定" id="btn_time_2" class="subbtn" />
					<div style="clear: both;">
					</div>
				</div>
				<div class="table_div">
					<table class="layui-table" id="test2" lay-filter="tableUser">

					</table>
				</div>
				<div style="clear: both;">
				</div>
			</div>
			<!--库存-->
			<div style="width: 20%;float: left; ">
				<div style="width: 90%;float: right;border-radius: 10px;">
					<div style="height: 50px;line-height: 50px;padding-left: 15px;font-size: 16px;color: #FFFFFF;background-color: #202B3D;border-radius: 10px 10px 0px 0px;">料仓一</div>
					<!-- <iframe id="v1" src="" style="width: 100%;overflow: hidden;border: none;"></iframe> -->
					<div id="player0">

					</div>
				</div>
				<div style="width: 90%;float: right;border-radius: 10px;">
					<div style="height: 50px;line-height: 50px;padding-left: 15px;font-size: 16px;color: #FFFFFF;background-color: #202B3D;border-radius: 10px 10px 0px 0px;">料仓二</div>
					<!-- <iframe id="v2" src="" style="width: 100%;overflow: hidden;border: none;"></iframe> -->
					<div>
						<video id="player1" controls="controls"></video>

					</div>
				</div>
			</div>
		</div>
		<!-- js部分 -->
		<script type="text/javascript" src="../../assets/js/server.js"></script>
		<script type="text/javascript" src="../../assets/libs/layui/layui.js"></script>
		<script type="text/javascript" src="../../assets/js/common.js?v=314"></script>
		<script type="text/javascript" src="../../assets/js/echarts.min.js"></script>
		<script type="text/javascript" src="../../assets/js/jquery-2.1.1.min.js"></script>
		<!-- <script src="../../assets/js/xgplayer.js" charset="utf-8"></script>
		<script src="../../assets/js/xgplayer-flv.js" charset="utf-8"></script> -->
		<script src="../../assets/js/hls.js" charset="utf-8"></script>
		<script>
			$(function() {
				bindVideo();
			});

			function bindVideo() {
				var zd = localStorage.getItem("station");
				var v1 = "";
				var v2 = "";
				var deviceWidth = document.documentElement.clientWidth;
				var playwidth = 306;
				var playheight = 240;
				if (deviceWidth < 1500) {
					playwidth = 207;
					playheight = 160;
				}
				$.get(url + video_api_url, {
					zhandian: zd,
					model_name: "物料管理-库存盘点",
					type: "pc"
				}, function(res) {
					for (var i = 0; i < res.length; i++) {
						var playerid = "player" + i;
						// var html="";
						// html+='<div class="monitor-box" style="margin-bottom:10px;" id='+playerid+'>';
						// html+='</div>';
						// $("#player0").append(html);

						setVideoFlvJsPlayer(playerid, res[i].url, playwidth, playheight);
					}
				})
				// switch (zd) {
				// 	case "璧山站":
				// 		v1 = "http://183.230.164.56:10810/play.html?channel=5&device=6984714942377&iframe=yes&aspect=300x240";
				// 		v2 = "http://183.230.164.56:10810/play.html?channel=6&device=6984714942377&iframe=yes&aspect=300x240";
				// 		break;
				// 	case "双石站":
				// 		v1 = "http://183.230.164.56:10810/play.html?channel=4&device=691810908353&iframe=yes&aspect=300x240";
				// 		v2 = "http://183.230.164.56:10810/play.html?channel=4&device=691810908353&iframe=yes&aspect=300x240";
				// 		break;
				// 	case "两江站":
				// 		v1 = "http://183.230.164.56:10810/play.html?channel=3&device=6984714942378&iframe=yes&aspect=300x240";
				// 		v2 = "http://183.230.164.56:10810/play.html?channel=10&device=6984714942378&iframe=yes&aspect=300x240";
				// 		break;
				// 	case "朱沱站":
				// 		v1 = "http://183.230.164.56:10810/play.html?channel=5&device=691810908354&iframe=yes&aspect=300x240";
				// 		v2 = "http://183.230.164.56:10810/play.html?channel=6&device=6984714942377&iframe=yes&aspect=300x240";
				// 		break;
				// }
				// $("#v1").attr("src", v1);
				// $("#v2").attr("src", v2);
			}

			// var iframeW = $("#v1").width();
			// $("#v1").attr("height", (iframeW / 300 * 240 + 5) + "px");
			// $("#v2").attr("height", (iframeW / 300 * 240 + 5) + "px");
			$(".xxk").on("click", function() {
				var data = $(this).attr("data");
				$(".xxk").removeClass("xxk_action");
				$(this).addClass("xxk_action");
				$(".layui-card").hide();
				$("#" + data).show();
			});
			console.log('test');
			var zd = localStorage.getItem("station");
			layui.use(['layer', 'form', 'table', 'util', 'admin', 'laydate'], function() {
				var type = 1;
				var data;
				var xData = [],
					yData = [];
				var min = 50;
				var kucun = echarts.init(document.getElementById("kucun"));
				var result = JSON.parse(
					'{"errno":0,"error":"","num":0,"obj":null,"list":[{"name":"石灰石0-5","value":4390.63},{"name":"石灰石5-10","value":6433.85},{"name":"石灰石10-15","value":4122.94},{"name":"石灰石20-30","value":10585.55},{"name":"花岗石10-15","value":1926.02},{"name":"花岗石5-10","value":871.92},{"name":"玄武岩5-10","value":11303.32},{"name":"玄武岩10-15","value":27853.29},{"name":"矿粉","value":179.03},{"name":"回收料","value":22029.35},{"name":"沥青70号","value":2929.17},{"name":"改性沥青","value":0},{"name":"回收粉","value":5846.95},{"name":"SBS沥青","value":63.17}]}'
				);
				data = result.list;
				initChart();


				function initChart() {

					data.map(function(a, b) {
						xData.push(a.name);
						if (a.value === 0) {
							yData.push(a.value + 0);
						} else {
							yData.push(a.value);
						}
					});


					var sourceBar = {
						"itemData": xData,
						"seriesData": yData
					}
					var itemData = sourceBar.itemData;
					var seriesData = sourceBar.seriesData;
					var tooltip = sourceBar.tooltip
					// var backgroundList = ['#0068b7', '#8c97cb', '#aa89bd', '#f6b37f', '#e27e34'];
					var color = ['#00b9f6', '#38a97d', '#004eff', '#17c7e7', '#4e85ea', '#e49be9', '#078d9d', '#eca52a', '#ef9544',
						'#ea3b3b'
					]


					var data2 = {};
					for (var k in itemData) {
						data2[itemData[k]] = seriesData[k];
					}

					var xAxisData = [];
					var dataArr = [];
					for (var i in data2) {
						xAxisData.push(i);
						dataArr.push(data2[i]);
					}

					option = {
						backgroundColor: '#142058',
						grid: {
							top: '25%',
							left: '1.5%',
							right: '10%',
							bottom: '8%',
							containLabel: true
						},
						tooltip: {
							show: "true",
							trigger: 'axis',
							axisPointer: { // 坐标轴指示器，坐标轴触发有效
								type: 'shadow', // 默认为直线，可选为：'line' | 'shadow'
								shadowStyle: {
									color: 'rgba(112,112,112,0)',
								},
							},
							formatter: function(params) {
								var unit = params[0].name.substring(params[0].name.indexOf('(') + 1, params[0].name.indexOf(')'));
								return params[0].name + '：' + params[0].value + '吨';
							},
							backgroundColor: 'rgba(0,0,0,0.7)', // 背景
							padding: [8, 10], //内边距
							extraCssText: 'box-shadow: 0 0 3px rgba(255, 255, 255, 0.4);', //添加阴影
						},
						xAxis: [{
							show: true,
							name: '来源',
							nameTextStyle: {
								fontSize: 14,
								fontFamily: 'Microsoft YaHei',
								color: '#fff'
							},
							type: 'category',
							nameLocation: 'end',
							nameGap: 8,
							axisLabel: {
								fontSize: 10,
								fontFamily: 'Microsoft YaHei',
								color: "#fff",
								interval: 0,
								margin: 16,
								formatter: function(params) {
									if (params.length > 6) {
										params = params.substr(0, 6) + "...";
									} else {
										params = params;

									}
									return params;
								}
							},
							axisLine: {
								show: true,
								symbol: ['none', 'arrow'],
								lineStyle: {
									color: '#05edfc'
								}
							},
							data: xAxisData
						}, {
							type: 'category',
							axisLine: {
								show: false
							},
							axisTick: {
								show: false
							},
							axisLabel: {
								show: false
							},
							splitArea: {
								show: false
							},
							splitLine: {
								show: false
							},
							data: xAxisData
						}, {
							type: 'category',
							axisLine: {
								show: false
							},
							axisTick: {
								show: false
							},
							axisLabel: {
								show: false
							},
							splitArea: {
								show: false
							},
							splitLine: {
								show: false
							},
							data: xAxisData
						}],
						yAxis: {
							type: 'value',
							name: '总量',
							nameTextStyle: {
								fontSize: 14,
								fontFamily: 'Microsoft YaHei',
								color: '#fff'
							},
							minInterval: 1,
							nameLocation: 'end',
							nameGap: 10,
							splitLine: {
								show: false
							},
							axisLabel: {
								show: true,
								fontSize: 12,
								fontFamily: 'Arial',
								color: "#fff"
							},
							axisLine: {
								show: true,
								symbol: ['none', 'arrow'],
								lineStyle: {
									color: '#05edfc'
								}
							}
						},
						series: [{
								type: 'bar',
								stack: 1,
								xAxisIndex: 0,
								barWidth: 5,
								barGap: 5,
								z: 2,
								data: function() {
									var itemArr = [];
									for (var i = 1; i < (dataArr.length + 1); i++) {
										var item = {
											value: dataArr[i - 1],
											itemStyle: {
												normal: {
													barBorderRadius: 50,
													color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
														offset: 0,
														color: color[translateColor(i) * 2 - 2]
													}, {
														offset: 1,
														color: color[translateColor(i) * 2 - 1]
													}]),
												}
											}
										};
										itemArr.push(item);
									}
									return itemArr;
								}()
							},
							{
								type: 'scatter',
								stack: 1,
								symbolOffset: [0, 0], //相对于原本位置的偏移量
								label: {
									normal: {
										show: false,
									}
								},
								xAxisIndex: 2,
								symbolSize: 10,
								z: 2,
								data: function() {
									var itemArr = [];
									for (var i = 1; i < (dataArr.length + 1); i++) {
										var item = {
											value: 0,
											itemStyle: {
												normal: {
													borderColor: '#fff',
													borderWidth: 2,
													color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
														offset: 0,
														color: color[translateColor(i) * 2 - 2]
													}, {
														offset: 1,
														color: color[translateColor(i) * 2 - 1]
													}]),
												}
											}
										};
										itemArr.push(item);
									}
									return itemArr;
								}()
							},
							{
								type: 'bar',
								xAxisIndex: 1,
								barGap: '140%',
								data: dataArr,
								barWidth: 12,
								itemStyle: {
									normal: {
										barBorderRadius: 50,
										color: '#0e2147'
									}
								},
								z: 1
							},
							{
								type: 'bar',
								xAxisIndex: 2,
								barWidth: 20,
								barGap: 1,
								z: 0,
								data: function() {
									var itemArr = [];
									for (var i = 1; i < (dataArr.length + 1); i++) {
										var item = {
											value: dataArr[i - 1],
											itemStyle: {
												normal: {
													barBorderRadius: 50,
													color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
														offset: 0,
														color: color[translateColor(i) * 2 - 2]
													}, {
														offset: 1,
														color: color[translateColor(i) * 2 - 1]
													}]),
												}
											}
										};
										itemArr.push(item);
									}
									return itemArr;
								}()
							},
							{
								type: 'scatter',
								hoverAnimation: false,
								xAxisIndex: 2,
								symbolOffset: [0, 0], //相对于原本位置的偏移量
								symbolSize: 18,
								z: 2,
								data: function() {
									var itemArr = [];
									for (var i = 1; i < (dataArr.length + 1); i++) {
										var item = {
											value: 0,
											itemStyle: {
												normal: {
													color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
														offset: 0,
														color: color[translateColor(i) * 2 - 2]
													}, {
														offset: 1,
														color: color[translateColor(i) * 2 - 1]
													}]),
												}
											}
										};
										itemArr.push(item);
									}
									return itemArr;
								}()
							}
						]
					};

					kucun.setOption(option);

					function translateColor(index) {
						if (index > 5) {
							return translateColor(index - 5)
						}
						return index
					};

				}

				layui.use('laydate', function() {
					var laydate = layui.laydate;
					laydate.render({
						elem: '#bdstartTime'

					});

					laydate.render({
						elem: '#bdendTime'
					});
				});

				layui.use('laydate', function() {
					var laydate = layui.laydate;
					laydate.render({
						elem: '#startTime'

					});

					laydate.render({
						elem: '#endTime'
					});
				});

				layui.use('laydate', function() {
					var laydate = layui.laydate;
					laydate.render({
						elem: '#startTime1'

					});

					laydate.render({
						elem: '#endTime1'

					});
				});

				var params = {
					beginDate: $('#startTime').val(),
					endDate: $('#endTime').val(),

				}

				initTable1(params)
				initTable2(params)
				initTable4(params)
				$('#btn_time_1').click(function() {
					params = {
						beginDate: $('#startTime').val(),
						endDate: $('#endTime').val(),
					}
					initTable1(params)
				})

				$('#btn_time_2').click(function() {
					params = {
						beginDate: $('#startTime1').val(),
						endDate: $('#endTime1').val()

					}
					initTable2(params)
				})

				$('#btn_time_3').click(function() {
					params = {
						beginDate: $('#bdstartTime').val(),
						endDate: $('#bdendTime').val(),
						type: $("#bdtype").val()
					}
					initTable4(params)
				})

				$("#bdtype").on("change", function() {
					params = {
						beginDate: $('#bdstartTime').val(),
						endDate: $('#bdendTime').val(),
						type: $("#bdtype").val()
					}
					initTable4(params)
				})

				$("[name='radio_jinliao']").on('click', function() {
					var beginDate;
					var endDate;

					$("[name='radio_jinliao']").removeClass("qdkaction");
					$(this).addClass("qdkaction");

					if ($(this).text() == '当日') {

						beginDate = showToDay();
						endDate = showToDay();

					} else if ($(this).text() == '本周') {

						beginDate = showWeekFirstDay();
						endDate = showWeekLastDay();
					} else if ($(this).text() == '本月') {

						beginDate = showMonthFirstDay();
						endDate = showMonthLastDay();
					}
					var params = {
						'beginDate': beginDate,
						'endDate': endDate,

					}

					initTable1(params)
				});

				$("[name='radio_chuliao']").on('click', function() {
					var beginDate;
					var endDate;

					$("[name='radio_chuliao']").removeClass("qdkaction");
					$(this).addClass("qdkaction");

					if ($(this).text() == '当日') {

						beginDate = showToDay();
						endDate = showToDay();

					} else if ($(this).text() == '本周') {

						beginDate = showWeekFirstDay();
						endDate = showWeekLastDay();
					} else if ($(this).text() == '本月') {

						beginDate = showMonthFirstDay();
						endDate = showMonthLastDay();
					}
					var params = {
						'beginDate': beginDate,
						'endDate': endDate,

					}

					initTable2(params)
				});

				$("[name='radio_bd']").on("click", function() {
					var beginDate;
					var endDate;

					$("[name='radio_bd']").removeClass("qdkaction");
					$(this).addClass("qdkaction");

					if ($(this).text() == '当日') {

						beginDate = showToDay();
						endDate = showToDay();

					} else if ($(this).text() == '本周') {

						beginDate = showWeekFirstDay();
						endDate = showWeekLastDay();
					} else if ($(this).text() == '本月') {

						beginDate = showMonthFirstDay();
						endDate = showMonthLastDay();
					}
					var params = {
						'beginDate': beginDate,
						'endDate': endDate,
						'type': $("#bdtype").val()
					}

					initTable4(params)
				});

				$("#button-name").on("click", function() {
					type = 1;

					$(".kcchecked").removeClass("kcchecked_action");
					$(this).addClass("kcchecked_action")

					var params2 = {
						beginDate: $('#startTime').val(),
						endDate: $('#endTime').val(),
					}
					initTable2(params2)
					initChart();
				})

				$("#button-name2").click(function() {
					type = 0;

					$(".kcchecked").removeClass("kcchecked_action");
					$(this).addClass("kcchecked_action")

					var params2 = {
						beginDate: $('#startTime').val(),
						endDate: $('#endTime').val(),
					}
					initTable2(params2);
					initChart();
				});



				function initTable1(params) {
					layui.use('table', function() {
						var table = layui.table;
						table.render({
							elem: '#test',
							url: getServerUrl(zd) + '/api/data/ajaxGetJinLiao',
							cellMinWidth: 80 //全局定义常规单元格的最小宽度
								,
							cols: [
								[{
									field: '石灰石0-5',
									title: '石灰石[0-5]',
									width: 100
								}, {
									field: '石灰石5-10',
									title: '石灰石[5-10]',
									width: 100
								}, {
									field: '石灰石10-15',
									title: '石灰石[10-15]',
									width: 100
								}, {
									field: '石灰石20-30',
									title: '石灰石[20-30]',
									width: 100
								}, {
									field: '花岗石5-10',
									title: '花岗石[5-10]',
									width: 100
								}, {
									field: '花岗石10-15',
									title: '花岗石[10-15]',
									width: 100
								}, {
									field: '玄武岩5-10',
									title: '玄武岩[5-10]',
									width: 100
								}, {
									field: '玄武岩10-15',
									title: '玄武岩[10-15]',
									width: 100
								}, {
									field: '沥青70号',
									title: '沥青70号',
									width: 100
								}, {
									field: '改性沥青',
									title: '改性沥青',
									width: 100
								}, {
									field: 'SBS沥青',
									title: 'SBS沥青',
									width: 100
								}, {
									field: '矿粉',
									title: '矿粉',
									width: 100
								}, {
									field: '回收粉',
									title: '回收粉',
									width: 100
								}, {
									field: '回收料',
									title: '回收料',
									width: 100
								}]
							],
							page: false,
							limit: 10,
							where: params,
							response: {
								statusName: 'errno' //数据状态的字段名称，默认：code
									,
								statusCode: 0 //成功的状态码，默认：0
									,
								msgName: 'error' //状态信息的字段名称，默认：msg
									,
								countName: 'num' //数据总数的字段名称，默认：count
									,
								dataName: 'list' //数据列表的字段名称，默认：data
							},
							even: true

						});
					});
				}
				/**
				,request: {
					    pageName: 'page' //页码的参数名称，默认：page
					    ,limitName: 'pageSize' //每页数据量的参数名，默认：limit
					   
					}
				**/
				function initTable2(params) {
					var index = layer.msg('数据请求中...')

					//根据请求类型 更换url

					var myurl = getServerUrl(zd) + '/api/data/ajaxGetChuLiao';
					if (type == 1) {
						myurl = getServerUrl(zd) + '/api/data/ajaxGetChuLiao_lilun';
					}
					layui.use('table', function() {
						var table = layui.table;
						table.render({
							elem: '#test2',
							url: myurl,
							cellMinWidth: 80 //全局定义常规单元格的最小宽度
								,
							cols: [
								[{
									field: 'item_0',
									title: '石灰石[0-5]',
									width: 100
								}, {
									field: 'item_1',
									title: '石灰石[5-10]',
									width: 100
								}, {
									field: 'item_2',
									title: '石灰石[10-15]',
									width: 100
								}, {
									field: 'item_3',
									title: '石灰石[20-30]',
									width: 100
								}, {
									field: '花岗石5-10',
									title: '花岗石[5-10]',
									width: 100
								}, {
									field: 'item_10',
									title: '花岗石[10-15]',
									width: 100
								}, {
									field: 'item_5',
									title: '玄武岩[5-10]',
									width: 100
								}, {
									field: 'item_6',
									title: '玄武岩[10-15]',
									width: 100
								}, {
									field: 'item_9',
									title: '沥青70号',
									width: 100
								}, {
									field: 'item_12',
									title: '改性沥青',
									width: 100
								}, {
									field: 'item_13',
									title: 'SBS沥青',
									width: 100
								}, {
									field: 'item_8',
									title: '矿粉',
									width: 100
								}, {
									field: 'item_7',
									title: '回收粉',
									width: 100
								}, {
									field: 'item_4',
									title: '回收料',
									width: 100
								}]
							],
							page: false,
							limit: 10,
							where: params,
							response: {
								statusName: 'errno' //数据状态的字段名称，默认：code
									,
								statusCode: 0 //成功的状态码，默认：0
									,
								msgName: 'error' //状态信息的字段名称，默认：msg
									,
								countName: 'num' //数据总数的字段名称，默认：count
									,
								dataName: 'list' //数据列表的字段名称，默认：data
							},
							even: true,
							done: function(res) { //返回数据执行回调函数
								layer.close(index); //返回数据关闭loading

							}
						});
					});
				}
function getServerUrls(zd)
{
	var api_urls='http://183.230.164.56:8025/';
	var serverUrl="";
	switch(zd)
	{
		case "两江站":
			serverUrl=api_urls+'liangjiang';
		break;
		case "璧山站":
			serverUrl=api_urls+'jbz';
		break;
		case "双石站":
			serverUrl=api_urls+'shuangshi';
		break;
		case "朱沱站":
			serverUrl=api_urls+'zhutuo'
		break;
		case "广州站":
			serverUrl=api_urls+'guangzhou'
		break;
		case "宏裕站":
			serverUrl=api_urls+'hongyu'
		break;
	}
	return serverUrl;
}
				function initTable4(params) {
					var index = layer.msg('数据请求中...')

					//根据请求类型 更换url
					layui.use('table', function() {
						var table = layui.table;
						table.render({
							style: 'mytabletextsize',
							elem: '#test3',
							//url: getServerUrl(zd) + '/api/data/ajaxShipmentList',
							url: getServerUrls(zd) + '/api/data/ajaxShipmentList',
							cellMinWidth: 80 //全局定义常规单元格的最小宽度
								,
							cols: [
								[{
									field: 'gbdh',
									title: '过磅单编号'
								}, {
									field: 'ccsj',
									title: '称重时间'
								}, {
									field: 'jz',
									title: '净重（吨）'
								}, {
									field: 'wl',
									title: '物料类型'
								}, {
									field: 'cph',
									title: '车牌号'
								}, {
									field: 'xm',
									title: '工程名称'
								}, {
									field: 'wldw',
									title: '物料单位'
								}, {
									field: 'bdzt',
									title: '运输状态'
								}]
							],
							page: true,
							toolbar: true,
							limit: 10,
							where: params,
							request: {
								pageName: 'page' //页码的参数名称，默认：page
									,
								limitName: 'pageSize' //每页数据量的参数名，默认：limit

							},
							response: {
								statusName: 'errno' //数据状态的字段名称，默认：code
									,
								statusCode: 0 //成功的状态码，默认：0
									,
								msgName: 'error' //状态信息的字段名称，默认：msg
									,
								countName: 'num' //数据总数的字段名称，默认：count
									,
								dataName: 'list' //数据列表的字段名称，默认：data
							},
							done: function(res) { //返回数据执行回调函数
								layer.close(index); //返回数据关闭loading

							}
						});
					});
				}

				function showToDay() {
					var Nowdate = new Date();
					M = Number(Nowdate.getMonth()) + 1
					var day = Nowdate.getDate();
					// alert((Nowdate.getDate()<10)?('0'+Nowdate.getDate()):Nowdate.getDate());
					return Nowdate.getFullYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + ((Nowdate.getDate() < 10) ? ('0' +
						Nowdate.getDate()) : Nowdate.getDate());
				}

				function showTomorrow() {
					var tom = new Date();
					tom.setDate(tom.getDate() + 1);
					M = Number(tom.getMonth()) + 1
					return tom.getYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + tom.getDate();
				}

				function showWeekFirstDay() {
					var Nowdate = new Date();
					var WeekFirstDay = new Date(Nowdate - (Nowdate.getDay() - 1) * 86400000);
					M = Number(WeekFirstDay.getMonth()) + 1
					return WeekFirstDay.getFullYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + ((WeekFirstDay.getDate() < 10) ? (
						'0' + WeekFirstDay.getDate()) : WeekFirstDay.getDate());
				}

				function showWeekLastDay() {
					var Nowdate = new Date();
					var WeekFirstDay = new Date(Nowdate - (Nowdate.getDay() - 1) * 86400000);
					var WeekLastDay = new Date((WeekFirstDay / 1000 + 6 * 86400) * 1000);
					M = Number(WeekLastDay.getMonth()) + 1
					return WeekLastDay.getFullYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + ((WeekLastDay.getDate() < 10) ? ('0' +
						WeekLastDay.getDate()) : WeekLastDay.getDate());
				}

				function showMonthFirstDay() {
					var Nowdate = new Date();
					var MonthFirstDay = new Date(Nowdate.getFullYear(), Nowdate.getMonth(), 1);
					M = Number(MonthFirstDay.getMonth()) + 1;
					return MonthFirstDay.getFullYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + ((MonthFirstDay.getDate() < 10) ?
						('0' + MonthFirstDay.getDate()) : MonthFirstDay.getDate());
				}

				function showMonthLastDay() {
					var Nowdate = new Date();
					var MonthNextFirstDay = new Date(Nowdate.getFullYear(), Nowdate.getMonth() + 1, 1);
					var MonthLastDay = new Date(MonthNextFirstDay - 86400000);
					M = Number(MonthLastDay.getMonth()) + 1;
					return MonthLastDay.getFullYear() + "-" + ((M < 10) ? ('0' + M) : M) + "-" + ((MonthLastDay.getDate() < 10) ? (
						'0' + MonthLastDay.getDate()) : MonthLastDay.getDate());
				}
			});

			function bindkucuncideo() {
				$("#kucunvideo").html('');
				var deviceWidth = document.documentElement.clientWidth;
				$.get(url + video_api_url, {
					zhandian: station,
					model_name: "物料管理-库存盘点",
					type: "pc"
				}, function(res) {
					for (var i = 0; i < res.length; i++) {
						var playerid = "player" + i;
						var html = "";
						html += '<div class="monitor-box" style="margin-bottom:10px;" id=' + playerid + '>';
						html += '</div>';
						$("#kucunvideo").append(html);

						setVideoFlvJsPlayer(playerid, res[i].url, 210, 160);
					}
				})
			}
		</script>

	</body>
</html>
