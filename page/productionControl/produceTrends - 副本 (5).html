<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title>生产动态表</title>
		<link rel="stylesheet" href="../../assets/libs/layui/css/layui.css" />
		<link rel="stylesheet" href="../../assets/module/admin.css?v=314" />
		<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
		<style>
			/*.layui-layer-setwin {*/
        /*    position: absolute;*/
        /*    right: 15px;*/
        /*    *right: 0;*/
        /*    top: 15px;*/
        /*    font-size: 0;*/
        /*    line-height: initial;*/
        /*}*/
		
		.my_title{
			width: 110px;
			height: 34px;
			background-color: #26C44F;
			text-align: center;
			color: #FFFFFF;
			font-size: 14px;
			line-height: 34px;
			float: left;
		}
		
		.layui-table-tool-temp {
			padding-right: 0;
			margin-right: 0;
			/*text-align: right;*/
		}
		
		.yutons,
		.layui-btn-sm {
			margin-top: -2px;
		}
		
		/* 修改头部工具右侧筛选、导出、打印样式 */
		.yutons-header-tool {
			margin-top: -2px;
			width: 30px !important;
			height: 30px !important;
			background-color: #ffffff;
		}
		
		/* 修改右侧筛选、导出、打印出发的ul标签定位 */
		.layui-table-tool-panel {
			left: auto;
			right: -1px;
		}
		
		/* div 右侧10px */
		.yutons-btn-margin-right {
			margin-right: 10px;
			line-height: 20px;
		}
		
		.layui-table-tool-self{
			display: none !important;
		}
		
		
		.width100
		{
			width: 100px !important;
		}
		
		.layui-laypage .layui-laypage-curr .layui-laypage-em {
		    position: absolute;
		    left: -1px;
		    top: -1px;
		    padding: 1px;
		    width: 100%;
		    height: 100%;
		    background-color: #26C44F;
		}
    </style>
	</head>
	<body>

		<!-- 页面加载loading -->
		<div class="page-loading">
			<div class="ball-loader">
				<span></span><span></span><span></span><span></span>
			</div>
		</div>

		<!-- 正文开始 -->
		<div class="layui-fluid">
			<div class="layui-card">
				<div class="layui-card-body table-tool-mini">
					<div class="layui-form toolbar">
						<!-- <div class="layui-form-item">
							<div class="layui-inline">
								<div class="my_title">
									生产动态表
								</div>
							</div>
						</div> -->
						<div class="layui-form-item" style="margin-top: 20px;">
							<div class="layui-inline">
								<div class="layui-input-inline mr0" style="width: 100px !important;">
									<input type="text" readonly="readonly" name="startTime" class="layui-input" id="test-laydate-start"
									 placeholder="开始日期" lay-key="1">
								</div>
							</div>
							<div class="layui-inline">
								<div class="layui-input-inline mr0" style="width: 100px !important;">
									<input type="text" readonly="readonly" name="endTime" class="layui-input" id="test-laydate-end" placeholder="结束日期"
									 lay-key="2">
								</div>
							</div>
							<div class="layui-inline">
								<button style="background-color: #26C44F;" class="layui-btn icon-btn layui-btn-green" lay-filter="formSubSearchUser"
								 lay-submit>
									确定
								</button>
							</div>
							<div class="layui-inline layui-col-md-2">
								<label class="layui-form-label w-auto">选择项目：</label>
								<div class="layui-input-inline width100 mr0">
									<select lay-filter="projectsel" class="select" lay-verify="type" name="projectsel" id="projectsel">
										<option value="">请选择</option>
									</select>
								</div>
							</div>
							<div class="layui-inline layui-col-md-2">
								<label class="layui-form-label w-auto">选择类型：</label>
								<div class="layui-input-inline width100 mr0">
									<select lay-filter="sel1" class="select" lay-verify="type" name="sel1" id="sel1">
										<option value=""> 请选择</option>
									</select>
								</div>
							</div>
							<div class="layui-inline">
								<label class="layui-form-label w-auto">异常类型：</label>
								<div class="layui-input-inline width100 mr0">
									<select lay-filter="sel2" class="select" lay-verify="type" name="sel2" id="sel2">
										<option value=""> 请选择</option>
										<option value="配比">配比</option>
										<option value="油石比">油石比</option>
									</select>
								</div>
							</div>
							<div class="layui-inline">
								<label class="layui-form-label w-auto">异常程度：</label>
								<div class="layui-input-inline width100 mr0">
									<select lay-filter="sel3" class="select" lay-verify="type" name="sel3" id="sel3">
										<option value=""> 请选择</option>
										<option value="一般">一般</option>
										<option value="严重">严重</option>
									</select>
								</div>
							</div>
						</div>
					</div>
					<table style="margin-top: 50px;" class="layui-table" id="tableUser" lay-filter="tableUser">
						<script type="text/html" id="toolbarDemo">
							<div class="layui-col-md12 layui-col-sm9 layui-col-xs6" style="text-align: left;">
								<div class="layui-input-inline yutons-btn-margin-right">
									<span style="background-color: #26C44F;" class="layui-btn yutons layui-btn-sm yutons-color-detail" lay-event="table_export" id="YutonsCallCenterWorkOrderSearch">单页导出</span>
								</div>
								<div class="layui-input-inline yutons-btn-margin-right">
									<span style="background-color: #26C44F;" class="layui-btn yutons layui-btn-sm yutons-color-detail" lay-event="table_export_all" id="YutonsCallCenterWorkOrderSearch">全部导出</span>
								</div>
								<div class="layui-input-inline yutons-btn-margin-right" style="margin-right: 0px;display:none">
									<span style="background-color: #26C44F;color: white;" class="layui-inline yutons-header-tool" title="筛选列" lay-event="LAYTABLE_COLS">
										<i class="layui-icon layui-icon-cols"></i></span>
									<span style="background-color: #26C44F;color: white;" class="layui-inline yutons-header-tool" title="导出" lay-event="LAYTABLE_EXPORT">
										<i class="layui-icon layui-icon-export"></i></span>
									<span style="background-color: #26C44F;color: white;" class="layui-inline yutons-header-tool" title="打印" lay-event="LAYTABLE_PRINT">
										<i class="layui-icon layui-icon-print"></i>
									</span>
								</div>
							</div>
						</script>
					</table>
				</div>
			</div>
		</div>
		</div>
		<!-- js部分 -->
		<script type="text/javascript" src="../../assets/js/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="../../assets/js/server.js"></script>
		<script type="text/javascript" src="../../assets/layui-excel-master/layui/layui.all.js"></script>
		<script type="text/javascript" src="../../assets/js/common.js?v=314"></script>
		<script>
			layui.use(['layer', 'form', 'table', 'util', 'laydate'], function() {
				var $ = layui.jquery;
				var layer = layui.layer;
				var laydate = layui.laydate;
				var form = layui.form;
				var table = layui.table;
				var util = layui.util;
				var zd = localStorage.getItem("station");
				var zhandianid = localStorage.getItem("station_id");
				var shebei_id = localStorage.getItem("shebei_id");
				var shebei_name = localStorage.getItem("shebei_name");
				var excel;
				// 表格初始化
				var gz;
				layui.config({
					base: '../../assets/layui-excel-master/layui_exts/'
				}).use(['table', 'excel'], function() {

					excel = layui.excel;
					console.log(excel);
				});

				var insTb;

				var limit=10;
				var limits=[10,20,30,40,50];
				if(zd == "鑫丰站")
				{
					limit=9;
					limits=[9,21,30,42];
				}
				setTimeout(function() {
					var zd = localStorage.getItem("station");

					var ysb_error = $("#sel3").find('option:selected').val();
					var state = $("#sel2").find('option:selected').val();
					var PN = $("#sel1").find('option:selected').val();
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						insTb = table.render({
							elem: '#tableUser',
							url: getServerUrl(zd) + '/api/data/ajaxList',
							page: true,
							cellMinWidth: 100,
							toolbar: '#toolbarDemo',
							where: params,
							limit: limit,
							limits:limits,
							cols: getCols(),
							request: {
								pageName: 'page' //页码的参数名称，默认：page
									,
								limitName: 'pageSize' //每页数据量的参数名，默认：limit

							},
							response: {
								statusName: 'errno' //数据状态的字段名称，默认：code
									,
								statusCode: 0 //成功的状态码，默认：0
									,
								msgName: 'error' //状态信息的字段名称，默认：msg
									,
								countName: 'num' //数据总数的字段名称，默认：count
									,
								dataName: 'list' //数据列表的字段名称，默认：data
							}
						});
					});
				}, 500);


				//查询
				// 搜索
				form.on('submit(formSubSearchUser)', function(data) {
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						getData();
					});
				});

				function getProject(params) {
					$.ajax({
						type: "get",
						url: getServerUrl(zd) + '/api/data/scProjectList',
						data: params,
						success: function(res) {
							if (res.errno == 0) {
								var str1 = "";
								for (var i = 0; i < res.list.length; i++) {
									str1 += '<option value="' + res.list[i] + '" data-id=' + i + '>' + res.list[i] + '</option>'
								}
								str1 = '<option value="">请选择</option>' + str1;
								$('#project').html(str1);
								layui.form.render("select");
							}
						}
					});
				}

				function getData() {
					var zd = localStorage.getItem("station");

					var ysb_error = $("#sel3").find('option:selected').val();
					var state = $("#sel2").find('option:selected').val();
					var PN = $("#sel1").find('option:selected').val();
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						type: $("#projectsel").val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}

					insTb.reload({
						where: params,
						page: {
							curr: 1
						}
					}, 'data');
					getProject(params);
					getType(params);
				}

				function getType(params) {
					var type = "get";
					var url = getServerUrl(zd) + '/api/data/ajaxGetPBHByDate';
					if (zd == "鑫丰站") {
						url = getServerUrl(zd) + '/api/data/getPBHList';
						type = "get";
					}
					$.ajax({
						type: type,
						url: url,
						data: params,
						success: function(res) {
							if (res.errno == 0) {
								var str1 = "";
								for (var i = 0; i < res.list.length; i++) {
									str1 += '<option data-id=' + i + '>' + res.list[i] + '</option>'
								}
								str1 = '<option>请选择</option>' + str1;
								$('#sel1').html(str1);
								layui.form.render("select");
							}
						}
					});
				}

				form.on('select(sel1)', function(data) {

					var ysb_error = $("#sel3").val();
					var state = $("#sel2").val();
					var PN = data.value;
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						type: $("#projectsel").val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						insTb.reload({
							where: params,
							page: {
								curr: 1
							}
						}, 'data');
					});
				})

				form.on('select(project)', function(data) {

					var ysb_error = $("#sel3").val();
					var state = $("#sel2").val();
					var PN = $("#sel1").val();
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						type: $("#projectsel").val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						insTb.reload({
							where: params,
							page: {
								curr: 1
							}
						}, 'data');
					});
				})

				form.on('select(sel2)', function(data) {

					var state = data.value;
					var ysb_error = $("#sel3").val();
					var PN = $("#sel1").val();
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						type: $("#projectsel").val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						insTb.reload({
							where: params,
							page: {
								curr: 1
							}
						}, 'data');
					});
				})

				//监听头工具栏事件
				table.on('toolbar(tableUser)', function(obj) {
					var checkStatus = table.checkStatus(obj.config.id),
						data = checkStatus.data; //获取选中的数据
					switch (obj.event) {
						case 'table_export':
							exportFile('tableUser')
							break;
						case 'table_export_all':
							exportApiDemo()
							break;
					};
				});

				function exportFile(id) {
					//根据传入tableID获取表头
					var headers = $("div[lay-id=" + id + "] .layui-table-box table").get(0);
					var htrs = Array.from(headers.querySelectorAll('tr'));
					var titles = {};
					for (var j = 0; j < htrs.length; j++) {
						var hths = Array.from(htrs[j].querySelectorAll("th"));
						for (var i = 0; i < hths.length; i++) {
							var clazz = hths[i].getAttributeNode('class').value;
							if (clazz != ' layui-table-col-special' && clazz != 'layui-hide') {
								//排除居左、具有、隐藏字段
								//修改:默认字段data-field+i,兼容部分数据表格中不存在data-field值的问题
								titles['data-field' + i] = hths[i].innerText;
							}
						}
					}
					//根据传入tableID获取table内容
					var bodys = $("div[lay-id=" + id + "] .layui-table-box table").get(1);
					var btrs = Array.from(bodys.querySelectorAll("tr"))
					var bodysArr = new Array();
					for (var j = 0; j < btrs.length; j++) {
						var contents = {};
						var btds = Array.from(btrs[j].querySelectorAll("td"));
						for (var i = 0; i < btds.length; i++) {
							for (var key in titles) {
								//修改:默认字段data-field+i,兼容部分数据表格中不存在data-field值的问题
								var field = 'data-field' + i;
								if (field === key) {
									//根据表头字段获取table内容字段
									contents[field] = btds[i].innerText;
								}
							}
						}
						bodysArr.push(contents)
					}
					//将标题行置顶添加到数组
					bodysArr.unshift(titles);
					//导出excel
					excel.exportExcel({
						sheet1: bodysArr
					}, '生产动态表' + new Date().toLocaleString() + '.xlsx', 'xlsx');
				}

				/**
				 * 导出接口数据的样例
				 * @return {[type]} [description]
				 */
				function exportApiDemo() {
					layui.use(['jquery', 'excel', 'layer'], function() {
						var $ = layui.jquery
						var layer = layui.layer
						var excel = layui.excel

						var ysb_error = $("#sel3").find('option:selected').val();
						var state = $("#sel2").find('option:selected').val();
						var PN = $("#sel1").find('option:selected').val();
						params = {
							beginDate: $('#test-laydate-start').val(),
							endDate: $('#test-laydate-end').val(),
							type: $("#projectsel").val(),
							"product": PN,
							"ysb_error": ysb_error,
							"state": state,
							sbName: shebei_name
						}
						// 模拟从后端接口读取需要导出的数据
						$.ajax({
							url: getServerUrl(zd) + '/api/data/ajaxListAll',
							type: 'POST',
							dataType: 'json',
							data: params,
							success: function(res) {
								var data = res.list
								switch (zd) {
									case "鑫丰站":
										debugger;
										$.each(data,function(i,item){
											if(item.state!=0)
											{
												item.one=item.one_S;
												item.two=item.two_S;
												item.three=item.three_S;
												item.four=item.four_S;
												item.five=item.five_S;
												item.six_1=item.six_S;
												item.six=item.seven_S;
												item.seven=item.six_1_S;
												item.ysb_1=item.ysb;
											}
										})
									
										data = excel.filterExportData(data, {
											dateTime: 'dateTime',
											guanci: 'guanci',
											one: 'one',
											two: 'two',
											three: 'three',
											four: 'four',
											five: 'five',
											six: 'six_1',
											field: 'six',
											seven: 'seven',
											huiShouLiao:'zshsl',
											eight: 'eight',
											ysb: 'ysb',
											zl:'zl'
										});

										// 重点2！！！一般都需要加一个表头，表头的键名顺序需要与最终导出的数据一致
										data.unshift({
											dateTime: "时间",
											guanci: "盘次",
											one: '仓1',
											two: '仓2',
											three: '仓3',
											four: '仓4',
											five: '仓5',
											six: '仓6',
											field: '粉料1',
											seven: '粉料2',
											huiShouLiao: '回收料',
											eight: '沥青',
											ysb: '油石比',
											zl:'重量'
										});
										break;
									default:
										// 重点！！！如果后端给的数据顺序和映射关系不对，请执行梳理函数后导出
										data = excel.filterExportData(data, {
											dateTime: 'dateTime',
											pbh: 'pbh',
											one: 'one_S',
											two: 'two_S',
											three: 'three_S',
											four: 'four_S',
											five: 'five_S',
											six: 'six_1_S',
											seven_1_s: 'seven_1_S',
											huiShou: 'huiShou_S',
											field: 'six_S',
											seven: 'seven_S',
											eight: 'eight',
											ysb: 'ysb',
											tjjsl: 'tjjsl',
											guanci: 'guanci'
										})
										// 重点2！！！一般都需要加一个表头，表头的键名顺序需要与最终导出的数据一致
										data.unshift({
											dateTime: "时间",
											pbh: "产品名称",
											one: '仓1',
											two: '仓2',
											three: '仓3',
											four: '仓4',
											five: '仓5',
											six: '仓6',
											seven_1_s: '仓7',
											field: '新粉1',
											seven: '新粉2',
											huiShou: '回收料',
											eight: '沥青',
											ysb: '油石比',
											tjjsl: '添加剂',
											guanci: '备注'
										})
								}
								console.log(data);
								console.log(data);
								var timestart = Date.now()
								excel.exportExcel({
									sheet1: data
								}, '导出接口数据.xlsx', 'xlsx')
								var timeend = Date.now()

								var spent = (timeend - timestart) / 1000
								layer.alert('单纯导出耗时 ' + spent + ' s')
							},
							error: function() {
								layer.alert('获取数据失败，请检查是否部署在本地服务器环境下')
							}
						})
					})
				}

				form.on('select(sel3)', function(data) {

					var ysb_error = data.value;
					var state = $("#sel2").val();
					var PN = $("#sel1").val();
					params = {
						beginDate: $('#test-laydate-start').val(),
						endDate: $('#test-laydate-end').val(),
						type: $("#project").val(),
						"product": PN,
						"ysb_error": ysb_error,
						"state": state,
						sbName: shebei_name
					}
					$.get(url + '/setting/getSettingDetailsList', {
						sb_id: shebei_id,
						zd_id: zhandianid,
						yccd: ($("#sel3").val()==''?'一般':$("#sel3").val())
					}, function(res) {
						localStorage.setItem("gz", JSON.stringify(res));
						insTb.reload({
							where: params,
							page: {
								curr: 1
							}
						}, 'data');
					});
				})

				//日期
				laydate.render({
					elem: '#test-laydate-start',
					trigger: 'click',
					format: 'yyyy-MM-dd',
					value: new Date(),
					done: function(value, date, endDate) {
						var startDate = new Date(value).getTime();
						var endTime = new Date($('#test-laydate-end').val()).getTime();
						if (endTime < startDate) {
							layer.msg('开始时间不能大于结束时间');
							$('#test-laydate-start').val($('#test-laydate-end').val());
						}
					}

				});
				laydate.render({
					elem: '#test-laydate-end',
					trigger: 'click',
					format: 'yyyy-MM-dd',
					value: new Date(),
					done: function(value, date, endDate) {
						var startDate = new Date($('#test-laydate-start').val()).getTime();
						var endTime = new Date(value).getTime();
						if (endTime < startDate) {
							layer.msg('结束时间不能小于开始时间');
							$('#test-laydate-end').val($('#test-laydate-start').val());
						}
					}
				});


				function setColor(fileName, setVal, val, setVal1, val1) {
					var gz = JSON.parse(localStorage.getItem("gz")).list;
					if(gz==null || gz==undefined)
					{
						return "";
					}
					var color = "";
					$.each(gz, function(i, item) {
						if (item.setting_name == fileName) {
							if (item.settingGroup == "LEFT") //括号外的数字
							{
								if (val - setVal < item.bg_size) {
									color = "blue";
									return false;
								} else if (val - setVal > item.ed_size) {
									color = "red";
									return false;
								} else {
									color = "";
									return false;
								}
							} else { //括号内的数字
								if (val1 - setVal1 < item.bg_size) {
									color = "blue";
									return false;
								} else if (val1 - setVal1 > item.ed_size) {
									color = "red";
									return false;
								} else {
									color = "";
									return false;
								}
							}
						}
					});
					return color;
				}
				
				function xfsetColor(hhl_type,fileName, setVal, val, setVal1, val1) {
					var gz = JSON.parse(localStorage.getItem("gz")).list;
					var color = "";
					if(hhl_type.indexOf('R')==0 && hhl_type.length>1)
					{
						hhl_type=hhl_type.substring(1,hhl_type.length);
					}
					$.each(gz, function(i, item) {
						if (item.setting_name == fileName && item.hhl_type==hhl_type) {
							if (item.settingGroup == "LEFT") //括号外的数字
							{
								if (parseFloat(val)  -parseFloat(setVal)< item.bg_size) {
									color = "blue";
									return false;
								} else if (parseFloat(val)  -parseFloat(setVal) > item.ed_size) {
									color = "red";
									return false;
								} else {
									color = "";
									return false;
								}
							} else { //括号内的数字
								if (parseFloat(val1)  -parseFloat(setVal1) < item.bg_size) {
									color = "blue";
									return false;
								} else if (parseFloat(val1)  -parseFloat(setVal1) > item.ed_size) {
									color = "red";
									return false;
								} else {
									color = "";
									return false;
								}
							}
						}
					});
					return color;
				}

				function getCols() {
					var cols = [];

					switch (zd) {
						case "两江站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven_1',
										title: '仓7',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_1_S + ' </span>'
											}
											var lv = (lastItemPB.seven_1_S == 0 ? 0 : parseFloat(lastItemPB.seven_1_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_1_S == 0 ? 0 : parseFloat(d.seven_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓7', lastItemPB.seven_1, d.seven_1, lv, nv) + ';"> ' + d.seven_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'huiShou',
										title: '回收料',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "源峰林站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven_1',
										title: '仓7',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_1_S + ' </span>'
											}
											var lv = (lastItemPB.seven_1_S == 0 ? 0 : parseFloat(lastItemPB.seven_1_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_1_S == 0 ? 0 : parseFloat(d.seven_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓7', lastItemPB.seven_1, d.seven_1, lv, nv) + ';"> ' + d.seven_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'huiShou',
										title: '回收料',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "璧山站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "双石站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "朱沱站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven_1',
										title: '仓7',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_1_S + ' </span>'
											}
											var lv = (lastItemPB.seven_1_S == 0 ? 0 : parseFloat(lastItemPB.seven_1_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_1_S == 0 ? 0 : parseFloat(d.seven_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓7', lastItemPB.seven_1, d.seven_1, lv, nv) + ';"> ' + d.seven_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青(油石比)',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '(' + (d.ysb.toFixed(2)) + ') </span>'
											}
											var lv = lastItemPB.ysb.toFixed(2);
											var nv = d.ysb.toFixed(2);
											var html = '<span style="color: ' + setColor('沥青(油石比)', lastItemPB.eight.toFixed(2), d.eight.toFixed(2),
												lv, nv) + ';"> ' + d.eight.toFixed(2) + '(' + (d.ysb.toFixed(2)) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "丰都站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											var sz = d.one_S.split('(')[1].split(')')[0];
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										title: '仓7',
										templet: function(d) {
											return '<span>0(0)</span>'
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'huiShou',
										title: '回收料',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
						case "广州站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间',
										width: 200
									}, {
										field: 'guanci',
										title: '锅次',
										width: 100
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'seven_1',
										title: '仓7',
										templet: function(d) {
											if (d.seven_1_S == undefined) {
												return '<span></span>'
											}
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_1_S + ' </span>'
											}
											var lv = (lastItemPB.seven_1_S == 0 ? 0 : parseFloat(lastItemPB.seven_1_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_1_S == 0 ? 0 : parseFloat(d.seven_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓7', lastItemPB.seven_1, d.seven_1, lv, nv) + ';"> ' + d.seven_1_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'huiShou',
										title: '回收粉',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'ysb',
										title: '油石比',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
									}
								]
							];
							break;
						case "沥青一厂":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间',
										width: 200
									}, {
										field: 'guanci',
										title: '锅次',
										width: 100
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'huiShou',
										title: '回收粉',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 80
									}, {
										field: 'ysb',
										title: '油石比',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
									}
								]
							];
							break;
						case "鑫丰站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间',
										width: 200
									}, {
										field: 'guanci',
										title: '盘次',
										width: 100
									}, {
										field: 'one_S_P',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓1', lastItemPB.one_S, d.one_S, lastItemPB.one_S, d.one_S) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'two_S_P',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓2', lastItemPB.two_S, d.two_S, lastItemPB.two_S, d.two_S) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'three_S_P',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓3', lastItemPB.three_S, d.three_S, lastItemPB.three_S, d.three_S) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'four_S_P',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓4', lastItemPB.four_S, d.four_S, lastItemPB.four_S, d.four_S) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'five_S_P',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓5', lastItemPB.five_S, d.five_S, lastItemPB.five_S, d.five_S) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_1_S_P',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓6', lastItemPB.six_1_S, d.six_1_S, lastItemPB.six_1_S, d.six_1_S) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_S_P',
										title: '粉料1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料1', lastItemPB.six_S, d.six_S, lastItemPB.six_S, d.six_S) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'seven_S_P',
										title: '粉料2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料2', lastItemPB.seven_S, d.seven_S, lastItemPB.seven_S, d.seven_S) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'zsl_S_P',
										title: '再生料',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.zsl_S ? 0:d.zsl_S + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'再生料', lastItemPB.zsl_S, d.zsl_S, lastItemPB.zsl_S, d.zsl_S) +
												';"> ' + d.zsl_S ? 0:d.zsl_S + ' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.eight + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'沥青', lastItemPB.eight, d.eight, lastItemPB.eight, d.eight) +
												';"> ' + d.eight + ' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'ysb',
										title: '油石比',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'油石比', lastItemPB.ysb, d.ysb,lastItemPB.ysb, d.ysb) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
									}, {
										field: 'zl',
										title: '重量',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span>' + d.total.toFixed(2) + ' </span>';
											}
											var html = '<span> ' + d.total.toFixed(2) + ' </span>';
											return html;
										},
									}, {
                                    field: 'ctotal',
                                    title: '石料总量',
                                    templet: function(d) {
										console.log(d.ctotal.toFixed(2))
                                        return d.ctotal.toFixed(2);
                                            // if (d.state == 0) {
                                            //     lastItemPB = d;
                                            //     return '<span> ' + d.ctotal.toFixed(2) + ' </span>'
                                            // }
                                            // var html = '<span style="color: ' + setColor('石料总量', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
                                            //     ';"> ' + d.ysb.toFixed(2) + ' </span>';
                                            // return html;
                                    },
                                }
								]
							];
							break;

						case "任丘站":
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间',
										width: 200
									}, {
										field: 'guanci',
										title: '盘次',
										width: 100
									}, {
										field: 'one_S_P',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.one_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓1', 0, 0, lastItemPB.one_S, d.one_S) + ';"> ' + d.one_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'two_S_P',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.two_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓2', 0, 0, lastItemPB.two_S, d.two_S) + ';"> ' + d.two_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'three_S_P',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.three_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓3', 0, 0, lastItemPB.three_S, d.three_S) + ';"> ' + d.three_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'four_S_P',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.four_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓4', 0, 0, lastItemPB.four_S, d.four_S) + ';"> ' + d.four_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'five_S_P',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.five_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓5', 0, 0, lastItemPB.FIVE, d.five_S) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_1_S_P',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓6', 0, 0, lastItemPB.six_1_S, d.six_1_S) + ';"> ' + d.six_1_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_S_P',
										title: '粉料1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料1', 0, 0, lastItemPB.six_S, d.six_S) + ';"> ' + d.six_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'seven_S_P',
										title: '粉料2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.seven_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料2', 0, 0, lastItemPB.seven_S, d.seven_S) + ';"> ' + d.seven_S_P +
												' </span>';
											return html;
										},
										width: 130
									},{
										field: 'zsl_S_P',
										title: '再生料',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.zsl_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'再生料', 0, 0, lastItemPB.zsl_S, d.zsl_S) +
												';"> ' + d.zsl_S_P + ' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.eight_1_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'沥青', 0, 0, lastItemPB.eight.toFixed(2), d.eight.toFixed(2)) +
												';"> ' + d.eight_1_S_P + ' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'ysb',
										title: '油石比',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'油石比', 0, 0,lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2)) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
									}, {
										field: 'zl',
										title: '重量',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span>' + d.total.toFixed(2) + ' </span>';
											}
											var html = '<span> ' + d.total.toFixed(2) + ' </span>';
											return html;
										},
									}, {
                                    field: 'ctotal',
                                    title: '石料总量',
                                    templet: function(d) {
										console.log(d.ctotal.toFixed(2))
                                        return d.ctotal.toFixed(2);
                                            // if (d.state == 0) {
                                            //     lastItemPB = d;
                                            //     return '<span> ' + d.ctotal.toFixed(2) + ' </span>'
                                            // }
                                            // var html = '<span style="color: ' + setColor('石料总量', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
                                            //     ';"> ' + d.ysb.toFixed(2) + ' </span>';
                                            // return html;
                                    },
                                }
								]
							];
							break;
						case "新基地":
							
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间',
										width: 200
									}, {
										field: 'guanci',
										title: '盘次',
										width: 100
									}, {
										field: 'one_S_P',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.one_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓1', lastItemPB.one_S, d.one_S, lastItemPB.one_S, d.one_S) + ';"> ' + d.one_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'two_S_P',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.two_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓2', lastItemPB.two_S, d.two_S, lastItemPB.two_S, d.two_S) + ';"> ' + d.two_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'three_S_P',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.three_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓3', lastItemPB.three_S, d.three_S, lastItemPB.three_S, d.three_S) + ';"> ' + d.three_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'four_S_P',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.four_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓4', lastItemPB.four_S, d.four_S, lastItemPB.four_S, d.four_S) + ';"> ' + d.four_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'five_S_P',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.five_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓5', lastItemPB.five_S, d.five_S, lastItemPB.five_S, d.five_S) + ';"> ' + d.five_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_1_S_P',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'仓6', lastItemPB.six_1_S, d.six_1_S, lastItemPB.six_1_S, d.six_1_S) + ';"> ' + d.six_1_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'six_S_P',
										title: '粉料1',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.six_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料1', lastItemPB.six_S, d.six_S, lastItemPB.six_S, d.six_S) + ';"> ' + d.six_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'seven_S_P',
										title: '粉料2',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.seven_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'粉料2', lastItemPB.seven_S, d.seven_S, lastItemPB.seven_S, d.seven_S) + ';"> ' + d.seven_S_P +
												' </span>';
											return html;
										},
										width: 130
									}, {
										field: 'zsl_S_P',
										title: '再生料',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.zsl_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'再生料', lastItemPB.zsl_S, d.zsl_S, lastItemPB.zsl_S, d.zsl_S) +
												';"> ' + d.zsl_S_P + ' </span>';
											return html;
										},
										width: 120
									},{
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.eight_1_S_P + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'沥青', lastItemPB.eight, d.eight, lastItemPB.eight, d.eight) +
												';"> ' + d.eight_1_S_P + ' </span>';
											return html;
										},
										width: 120
									}, {
										field: 'ysb',
										title: '油石比',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + xfsetColor(d.pbh,'油石比', lastItemPB.ysb, d.ysb,lastItemPB.ysb, d.ysb) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
									}, {
										field: 'zl',
										title: '重量',
										templet: function(d) {
											if (d.state == 0 || d.state == 2) {
												lastItemPB = d;
												return '<span>' + d.total.toFixed(2) + ' </span>';
											}
											var html = '<span> ' + d.total.toFixed(2) + ' </span>';
											return html;
										},
									}, {
                                    field: 'ctotal',
                                    title: '石料总量',
                                    templet: function(d) {
										console.log(d.ctotal.toFixed(2))
                                        return d.ctotal.toFixed(2);
                                            // if (d.state == 0) {
                                            //     lastItemPB = d;
                                            //     return '<span> ' + d.ctotal.toFixed(2) + ' </span>'
                                            // }
                                            // var html = '<span style="color: ' + setColor('石料总量', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
                                            //     ';"> ' + d.ysb.toFixed(2) + ' </span>';
                                            // return html;
                                    },
                                }
								]
							];
							break;
						default:
							cols = [
								[ //标题栏
									{
										field: 'dateTime',
										title: '时间'
									}, {
										field: 'pbh',
										title: '产品名称'
									}, {
										field: 'one',
										title: '仓1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.one_S + ' </span>'
											}
											var lv = (lastItemPB.one_S == 0 ? 0 : parseFloat(lastItemPB.one_S.split('(')[1].split(')')[0]));
											var nv = (d.one_S == 0 ? 0 : parseFloat(d.one_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓1', lastItemPB.one, d.one, lv, nv) + ';"> ' + d.one_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'two',
										title: '仓2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.two_S + ' </span>'
											}
											var lv = (lastItemPB.two_S == 0 ? 0 : parseFloat(lastItemPB.two_S.split('(')[1].split(')')[0]));
											var nv = (d.two_S == 0 ? 0 : parseFloat(d.two_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓2', lastItemPB.two, d.two, lv, nv) + ';"> ' + d.two_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'three',
										title: '仓3',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.three_S + ' </span>'
											}
											var lv = (lastItemPB.three_S == 0 ? 0 : parseFloat(lastItemPB.three_S.split('(')[1].split(')')[0]));
											var nv = (d.three_S == 0 ? 0 : parseFloat(d.three_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓3', lastItemPB.three, d.three, lv, nv) + ';"> ' + d.three_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'four',
										title: '仓4',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.four_S + ' </span>'
											}
											var lv = (lastItemPB.four_S == 0 ? 0 : parseFloat(lastItemPB.four_S.split('(')[1].split(')')[0]));
											var nv = (d.four_S == 0 ? 0 : parseFloat(d.four_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓4', lastItemPB.four, d.four, lv, nv) + ';"> ' + d.four_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'five',
										title: '仓5',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.five_S + ' </span>'
											}
											var lv = (lastItemPB.five_S == 0 ? 0 : parseFloat(lastItemPB.five_S.split('(')[1].split(')')[0]));
											var nv = (d.five_S == 0 ? 0 : parseFloat(d.five_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓5', lastItemPB.five, d.five, lv, nv) + ';"> ' + d.five_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six_1',
										title: '仓6',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_1_S + ' </span>'
											}
											var lv = (lastItemPB.six_1_S == 0 ? 0 : parseFloat(lastItemPB.six_1_S.split('(')[1].split(')')[0]));
											var nv = (d.six_1_S == 0 ? 0 : parseFloat(d.six_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓6', lastItemPB.six_1, d.six_1, lv, nv) + ';"> ' + d.six_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven_1',
										title: '仓7',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_1_S + ' </span>'
											}
											var lv = (lastItemPB.seven_1_S == 0 ? 0 : parseFloat(lastItemPB.seven_1_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_1_S == 0 ? 0 : parseFloat(d.seven_1_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('仓7', lastItemPB.seven_1, d.seven_1, lv, nv) + ';"> ' + d.seven_1_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'six',
										title: '新粉1',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.six_S + ' </span>'
											}
											var lv = (lastItemPB.six_S == 0 ? 0 : parseFloat(lastItemPB.six_S.split('(')[1].split(')')[0]));
											var nv = (d.six_S == 0 ? 0 : parseFloat(d.six_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉1', lastItemPB.six, d.six, lv, nv) + ';"> ' + d.six_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'seven',
										title: '新粉2',
										templet: function(d) {
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.seven_S + ' </span>'
											}
											var lv = (lastItemPB.seven_S == 0 ? 0 : parseFloat(lastItemPB.seven_S.split('(')[1].split(')')[0]));
											var nv = (d.seven_S == 0 ? 0 : parseFloat(d.seven_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('新粉2', lastItemPB.seven, d.seven, lv, nv) + ';"> ' + d.seven_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'huiShou',
										title: '回收料',
										templet: function(d) {
											if (d.huiShou_S == undefined) {
												return '<span></span>'
											}
											if (d.state == 0) {
												lastItemPB = d;
												return '<span> ' + d.huiShou_S + ' </span>'
											}
											var lv = (lastItemPB.huiShou_S == 0 ? 0 : parseFloat(lastItemPB.huiShou_S.split('(')[1].split(')')[0]));
											var nv = (d.huiShou_S == 0 ? 0 : parseFloat(d.huiShou_S.split('(')[1].split(')')[0]));
											var html = '<span style="color: ' + setColor('回收粉', lastItemPB.huiShou, d.huiShou, lv, nv) + ';"> ' + d.huiShou_S +
												' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '沥青',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.eight.toFixed(2) + '</span>'
											}
											var html = '<span style="color: ' + setColor('沥青', lastItemPB.eight.toFixed(2), d.eight.toFixed(2), 0, 0) +
												';"> ' + d.eight.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'eight',
										title: '油石比',
										templet: function(d) {
											if (d.guanci == '配比') {
												lastItemPB = d;
												return '<span> ' + d.ysb.toFixed(2) + ' </span>'
											}
											var html = '<span style="color: ' + setColor('油石比', lastItemPB.ysb.toFixed(2), d.ysb.toFixed(2), 0, 0) +
												';"> ' + d.ysb.toFixed(2) + ' </span>';
											return html;
										},
										width: 100
									}, {
										field: 'tjjsl',
										title: '添加剂'
									}, {
										field: 'guanci',
										title: '备注'
									}
								]
							];
							break;
					}

					return cols;
				}
			});
		</script>

	</body>
</html>
